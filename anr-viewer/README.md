# ANR Visualization Web App

A standalone React + TypeScript page that understands the `block_anr` files generated by BlockMoonlightTreasureBox. It decodes the serialized `AnrInfo` payload directly in the browser and renders the main-thread message queue, scheduling timeline, and collected traces so you can quickly pinpoint the ANR node.

## Development

```bash
cd anr-viewer
npm install
npm run dev
```

The dev server runs on <http://localhost:5173>. Hot reload is enabled.

## Production build

```bash
npm run build
```

The build artifacts will be generated inside `dist/`.

## Using the page

1. Open the app (either via `npm run dev` or any static host that serves `dist/`).
2. Click **“选择 ANR 文件”** and pick a `.anr` file collected from the device (it is the serialized `AnrInfo` that BlockMoonlightTreasureBox saves under `block_anr`).
3. The parser runs completely in the browser, draws a visual timeline, highlights the ANR node, and shows tooltips with handler + trace information.
4. Use **“定位 ANR 节点”** to jump to the message that triggered the ANR.

For a quick demo there is a tiny fixture in `public/sample.anr`; load it via the button to see the timeline without pulling logs from a device.

## Limitations

- The custom Java serialization parser currently covers the set of classes that appear in the Moonlight Treasure Box output (AnrInfo, TimeLruCache, MessageInfo, ScheduledInfo, BoxMessage, ArrayList, LinkedHashMap, StringBuilder, primitives). If future versions add new structures, extend `src/lib/javaDeserialization.ts` accordingly.
- Files from other ANR tools or different serialization formats are not supported.
